<!doctype html>
<html lang="fa">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<title>Pong Mobile & Desktop</title>

<style>
html,body{
  margin:0;
  padding:0;
  width:100%;
  height:100%;
  background:#050b1a;
  overflow:hidden;
  touch-action:none;
  font-family:system-ui;
}
canvas{display:block;}
#ui{
  position:fixed;
  top:10px;
  left:50%;
  transform:translateX(-50%);
  display:flex;
  gap:14px;
  align-items:center;
  color:white;
  font-size:18px;
  font-weight:700;
  z-index:10;
}
button{
  background:#0c1530;
  border:1px solid #223;
  color:white;
  border-radius:8px;
  padding:6px 10px;
  font-size:14px;
}
</style>
</head>
<body>

<div id="ui">
  <button id="modeBtn">ðŸ‘¤ðŸ‘¤</button>
  <div><span id="l">0</span> : <span id="r">0</span></div>
</div>

<canvas id="c"></canvas>

<script>
const canvas = document.getElementById("c");
const ctx = canvas.getContext("2d");

function resize(){
  const vh = window.visualViewport ? visualViewport.height : innerHeight;
  canvas.width = innerWidth;
  canvas.height = vh;
}
resize();
addEventListener("resize",resize);

/* mode */
let singlePlayer = false;
const modeBtn = document.getElementById("modeBtn");

/* score */
let scoreL=0, scoreR=0;
const scoreLEl=document.getElementById("l");
const scoreREl=document.getElementById("r");

/* objects */
const paddleW=14;
let paddleH;

const left={x:0,y:0};
const right={x:0,y:0};

const ball={x:0,y:0,vx:0,vy:0,r:8,speed:6};

function resetBall(dir=1){
  ball.x=canvas.width/2;
  ball.y=canvas.height/2;
  const a=(Math.random()*Math.PI/3)-(Math.PI/6);
  ball.vx=dir*ball.speed*Math.cos(a);
  ball.vy=ball.speed*Math.sin(a);
}

function resetGame(){
  scoreL=scoreR=0;
  scoreLEl.textContent=scoreL;
  scoreREl.textContent=scoreR;
  ball.speed=6;
  resetBall(Math.random()>0.5?1:-1);
}

/* init */
function init(){
  paddleH=canvas.height*0.18;
  left.x=30;
  right.x=canvas.width-30;
  left.y=right.y=canvas.height/2;
  resetBall(Math.random()>0.5?1:-1);
}
init();

/* input */
function handle(y,isRight){
  if(isRight) right.y=y;
  else left.y=y;
}

addEventListener("pointermove",e=>{
  if(singlePlayer){
    handle(e.clientY,false);
  }else{
    const half=canvas.width/2;
    if(e.clientX<half) handle(e.clientY,false);
    else handle(e.clientY,true);
  }
});

/* helpers */
const clamp=(v,a,b)=>Math.max(a,Math.min(b,v));

function reflect(p){
  const rel=(ball.y-p.y)/(paddleH/2);
  const ang=rel*Math.PI*0.45;
  ball.speed=Math.min(ball.speed*1.05,16);
  const dir=p===left?1:-1;
  ball.vx=dir*ball.speed*Math.cos(ang);
  ball.vy=ball.speed*Math.sin(ang);
}
  const GOAL_OFFSET = 100; // Ù‡Ø±Ú†ÛŒ Ø¨ÛŒØ´ØªØ± = Ú¯Ù„ Ø¯ÛŒØ±ØªØ± Ø­Ø³Ø§Ø¨ Ù…ÛŒØ´Ù‡

/* AI */
function aiMove(){
  const target = ball.y;
  const speed = 0.12;
  right.y += (target - right.y) * speed;
}

/* loop */
function loop(){
  paddleH=canvas.height*0.18;

  ball.x+=ball.vx;
  ball.y+=ball.vy;

  if(ball.y<ball.r||ball.y>canvas.height-ball.r)
    ball.vy*=-1;

  if(singlePlayer) aiMove();

  // left paddle
  if(ball.x - ball.r < GOAL_OFFSET){
    if(Math.abs(ball.y-left.y)<paddleH/2){
      reflect(left);
    }else{
      scoreR++; scoreREl.textContent=scoreR;
      ball.speed=6;
      resetBall(1);
    }
  }

  // right paddle
    if(ball.x + ball.r > canvas.width - GOAL_OFFSET){
    if(Math.abs(ball.y-right.y)<paddleH/2){
      reflect(right);
    }else{
      scoreL++; scoreLEl.textContent=scoreL;
      ball.speed=6;
      resetBall(-1);
    }
  }

  left.y=clamp(left.y,paddleH/2,canvas.height-paddleH/2);
  right.y=clamp(right.y,paddleH/2,canvas.height-paddleH/2);

  ctx.clearRect(0,0,canvas.width,canvas.height);
  ctx.fillStyle="#fff";

  ctx.fillRect(left.x-paddleW/2,left.y-paddleH/2,paddleW,paddleH);
  ctx.fillRect(right.x-paddleW/2,right.y-paddleH/2,paddleW,paddleH);

  ctx.beginPath();
  ctx.arc(ball.x,ball.y,ball.r,0,Math.PI*2);
  ctx.fill();

  requestAnimationFrame(loop);
}
loop();

/* mode toggle */
modeBtn.onclick=()=>{
  singlePlayer=!singlePlayer;
  modeBtn.textContent = singlePlayer ? "ðŸ‘¤ðŸ¤–" : "ðŸ‘¤ðŸ‘¤";
  resetGame();
};
</script>

</body>
</html>
